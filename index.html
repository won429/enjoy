<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ì—”ìª½ì´ ë®¤ì§</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { 
            font-family: 'Pretendard', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            background-color: #030712; /* Deep Dark Background */
        }
        
        /* LP íšŒì „ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes spin-lp {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .spinning {
            animation: spin-lp 10s linear infinite;
        }
        
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* ëª¨ë°”ì¼ í•˜ë‹¨ ì•ˆì „ ì˜ì—­ (ì•„ì´í° í™ˆë°” ëŒ€ì‘) */
        .pb-safe {
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }
        .mb-safe {
            margin-bottom: env(safe-area-inset-bottom, 20px);
        }
    </style>
</head>
<!-- ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € ë†’ì´ ì´ìŠˆ í•´ê²°ì„ ìœ„í•´ h-[100dvh] ì‚¬ìš© -->
<body class="text-white overflow-hidden select-none h-[100dvh] w-screen fixed bg-[#121212]">

    <!-- ==================== 1. í™ˆ í™”ë©´ (ìŠ¤íŠ¸ë¦¬ë° ì•± ìŠ¤íƒ€ì¼) ==================== -->
    <div id="home-screen" class="relative z-10 h-full flex flex-col fade-in">
        
        <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="px-6 pt-8 pb-4 flex justify-between items-center bg-[#121212]">
            <h1 class="text-2xl font-bold flex items-center gap-2">
                <!-- ìš”ì²­í•˜ì‹ ëŒ€ë¡œ ì´ë¦„ ë³€ê²½ -->
                <span class="text-green-400">Enjoy</span> Music
            </h1>
            <div class="w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center overflow-hidden">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
            </div>
        </div>

        <!-- ë©”ì¸ ìŠ¤í¬ë¡¤ ì˜ì—­ -->
        <div class="flex-1 overflow-y-auto scrollbar-hide pb-32 px-6">
            
            <!-- ë©”ì¸ ë°°ë„ˆ (ì˜¤ëŠ˜ì˜ ì¶”ì²œ) -->
            <div class="mb-8 mt-2 cursor-pointer group" onclick="openPlayer(0)">
                <p class="text-xs text-gray-400 font-bold tracking-widest mb-3">TODAY'S PICK</p>
                <div class="relative aspect-square w-full max-h-80 rounded-[32px] overflow-hidden shadow-2xl">
                    <img src="./cover.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" onerror="this.style.display='none'">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
                    <div class="absolute bottom-0 left-0 p-6">
                        <h2 class="text-3xl font-bold mb-1">ë¹›</h2>
                        <p class="text-gray-300 font-medium">ì—”ìª½ì´ OST Part.1</p>
                        <div class="mt-4 inline-flex items-center gap-2 bg-green-500 text-black px-4 py-2 rounded-full font-bold text-sm hover:bg-green-400 transition-colors">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                            Play Now
                        </div>
                    </div>
                </div>
            </div>

            <!-- í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ -->
            <div class="mb-6">
                <h3 class="text-lg font-bold mb-4 flex items-center justify-between">
                    My Playlist
                    <span class="text-xs text-gray-500 font-normal">See all</span>
                </h3>
                <div id="song-list" class="space-y-3">
                    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ë¦¬ìŠ¤íŠ¸ê°€ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- ğŸ”¥ ë¯¸ë‹ˆ í”Œë ˆì´ì–´ (í•˜ë‹¨ ê³ ì • + ëª¨ë°”ì¼ ì•ˆì „ ì˜ì—­ ì ìš©) -->
        <div id="mini-player" class="absolute bottom-0 left-0 right-0 bg-[#1E1E1E] border-t border-white/5 px-4 pt-3 pb-safe cursor-pointer translate-y-full transition-transform duration-300 z-20" onclick="openPlayer(currentIdx)">
            <div class="flex items-center justify-between mb-1">
                <div class="flex items-center gap-3">
                    <!-- ë¯¸ë‹ˆ ì•¨ë²”ì•„íŠ¸ -->
                    <div class="w-12 h-12 rounded-lg overflow-hidden bg-gray-800 relative">
                        <img id="mini-cover" src="./cover.jpg" class="w-full h-full object-cover">
                    </div>
                    <!-- ê³¡ ì •ë³´ -->
                    <div class="flex flex-col justify-center">
                        <h4 id="mini-title" class="text-sm font-bold text-white truncate max-w-[150px]">ë¹›</h4>
                        <p id="mini-artist" class="text-xs text-gray-400 truncate">ì—”ìª½ì´ OST</p>
                    </div>
                </div>

                <!-- ë¯¸ë‹ˆ ì»¨íŠ¸ë¡¤ -->
                <div class="flex items-center gap-4 pr-2">
                    <button id="mini-play-btn" class="w-10 h-10 flex items-center justify-center bg-white text-black rounded-full shadow-md active:scale-90 transition-transform" onclick="event.stopPropagation(); togglePlay();">
                        <svg id="mini-icon-play" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        <svg id="mini-icon-pause" class="hidden" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
                    </button>
                </div>
            </div>
            <!-- ë¯¸ë‹ˆ ì§„í–‰ë°” -->
            <div class="absolute top-0 left-0 right-0 h-0.5 bg-white/10">
                <div id="mini-progress" class="h-full bg-green-500 w-0 transition-all duration-300"></div>
            </div>
        </div>
    </div>


    <!-- ==================== 2. ì „ì²´ í”Œë ˆì´ì–´ í™”ë©´ (ì˜¤ë²„ë ˆì´) ==================== -->
    <div id="player-screen" class="fixed inset-0 z-50 bg-[#121212] transform translate-y-full transition-transform duration-500 flex flex-col h-[100dvh]">
        
        <!-- ë°°ê²½ ë¸”ëŸ¬ (ì•¨ë²”ì•„íŠ¸ ê¸°ë°˜) -->
        <div class="absolute inset-0 z-0 opacity-30 pointer-events-none">
            <img id="player-bg-image" src="./cover.jpg" class="w-full h-full object-cover blur-3xl scale-150">
            <div class="absolute inset-0 bg-gradient-to-b from-[#121212] via-transparent to-[#121212]"></div>
        </div>

        <!-- í”Œë ˆì´ì–´ ìƒë‹¨ë°” -->
        <div class="relative z-10 flex justify-between items-center p-6 pt-10">
            <button id="btn-minimize" class="p-2 rounded-full text-white/70 hover:text-white hover:bg-white/10 transition-all">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
            </button>
            <span class="text-xs font-bold tracking-[0.2em] text-white/60">NOW PLAYING</span>
            <button class="p-2 rounded-full text-white/70 hover:text-white hover:bg-white/10 transition-all">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
            </button>
        </div>

        <!-- í”Œë ˆì´ì–´ ë©”ì¸ -->
        <div class="relative z-10 flex-1 flex flex-col items-center justify-center px-8 pb-12">
             
             <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
             <div id="error-box" class="hidden bg-red-500/90 text-white text-xs p-3 rounded-xl mb-8 text-center animate-pulse w-full max-w-xs">
                <p>íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                <p class="mt-1 opacity-75 text-[10px]">music.mp3 ì™€ cover.jpg í™•ì¸ í•„ìš”</p>
            </div>

            <!-- ì•¨ë²” ì•„íŠ¸ -->
            <div class="relative w-full max-w-[320px] aspect-square mb-auto mt-4 group">
                <div id="lp-disk" class="w-full h-full rounded-full shadow-[0_20px_50px_rgba(0,0,0,0.5)] border-[8px] border-[#1a1a1a] relative bg-[#1a1a1a] overflow-hidden">
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[60%] h-[60%] rounded-full overflow-hidden border-4 border-[#2a2a2a] z-10 bg-gray-800">
                        <img id="cover-image" src="./cover.jpg" class="w-full h-full object-cover opacity-90">
                    </div>
                    <!-- LP ì§ˆê° -->
                    <div class="absolute inset-0 rounded-full border-[2px] border-white/5 pointer-events-none" style="clip-path: circle(45%)"></div>
                    <div class="absolute inset-0 rounded-full border-[2px] border-white/5 pointer-events-none" style="clip-path: circle(35%)"></div>
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-4 h-4 bg-white/80 rounded-full z-20 shadow-lg"></div>
                </div>
            </div>

            <!-- ì •ë³´ -->
            <div class="w-full mb-8 flex items-end justify-between">
                <div class="flex-1 min-w-0 mr-4">
                    <h2 id="song-title" class="text-2xl font-bold text-white mb-1 truncate scroll-m-0">ë¹›</h2>
                    <p id="song-artist" class="text-white/60 text-base font-medium truncate">ì—”ìª½ì´ OST Part.1</p>
                </div>
                <button class="text-green-400 hover:scale-110 transition-transform">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                </button>
            </div>

            <!-- ì§„í–‰ ë°” -->
            <div class="w-full mb-2">
                <div class="relative h-1.5 bg-white/10 rounded-full cursor-pointer group" id="progress-container">
                    <div id="progress-fill" class="absolute top-0 left-0 h-full bg-white rounded-full transition-all duration-100 group-hover:bg-green-400" style="width: 0%"></div>
                    <div class="absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white rounded-full shadow opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none" id="progress-handle" style="left: 0%"></div>
                    <input type="range" id="seek-slider" min="0" max="100" value="0" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                </div>
                <div class="flex justify-between text-xs text-white/40 mt-2 font-mono font-medium">
                    <span id="current-time">00:00</span>
                    <span id="duration">00:00</span>
                </div>
            </div>

            <!-- ì»¨íŠ¸ë¡¤ëŸ¬ (ì•ˆì „ ì˜ì—­ padding ì¶”ê°€) -->
            <div class="mt-auto w-full flex justify-between items-center px-2 pb-safe pt-4">
                <button class="text-white/40 hover:text-white transition-colors">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 8l-4 4 4 4"></path><path d="M10 12H20"></path></svg>
                </button>

                <div class="flex items-center gap-8">
                    <button id="btn-prev" class="text-white hover:text-green-400 active:scale-90 transition-all">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="19 20 9 12 19 4 19 20"></polygon><line x1="5" y1="19" x2="5" y2="5"></line></svg>
                    </button>
                    
                    <button id="btn-play" class="w-20 h-20 flex items-center justify-center bg-green-500 text-black rounded-full shadow-[0_0_30px_rgba(74,222,128,0.3)] hover:scale-105 hover:bg-green-400 active:scale-95 transition-all">
                        <svg id="icon-play" width="36" height="36" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        <svg id="icon-pause" class="hidden" width="36" height="36" viewBox="0 0 24 24" fill="currentColor" stroke="none"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
                    </button>
                    
                    <button id="btn-next" class="text-white hover:text-green-400 active:scale-90 transition-all">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg>
                    </button>
                </div>

                <button class="text-white/40 hover:text-white transition-colors">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="17 1 21 5 17 9"></polyline><path d="M3 11V9a4 4 0 0 1 4-4h14"></path><polyline points="7 23 3 19 7 15"></polyline><path d="M21 13v2a4 4 0 0 1-4 4H3"></path></svg>
                </button>
            </div>
        </div>
    </div>

    <!-- ì˜¤ë””ì˜¤ íƒœê·¸ -->
    <audio id="audio" playsinline webkit-playsinline></audio>

    <script>
        // ==================== ë°ì´í„° ====================
        const songs = [
            {
                id: 1,
                title: "ë¹›",
                artist: "ì—”ìª½ì´ OST Part.1",
                src: "./music.mp3", 
                cover: "./cover.jpg"
            }
        ];

        // ==================== ì „ì—­ ë³€ìˆ˜ ====================
        let currentIdx = 0;
        let isPlaying = false;

        // ==================== DOM ìš”ì†Œ ====================
        const audio = document.getElementById('audio');
        const homeScreen = document.getElementById('home-screen');
        const songList = document.getElementById('song-list');
        const playerScreen = document.getElementById('player-screen');
        const miniPlayer = document.getElementById('mini-player');
        
        // ë¯¸ë‹ˆ í”Œë ˆì´ì–´ ìš”ì†Œ
        const miniCover = document.getElementById('mini-cover');
        const miniTitle = document.getElementById('mini-title');
        const miniArtist = document.getElementById('mini-artist');
        const miniIconPlay = document.getElementById('mini-icon-play');
        const miniIconPause = document.getElementById('mini-icon-pause');
        const miniProgress = document.getElementById('mini-progress');

        // ì „ì²´ í”Œë ˆì´ì–´ ìš”ì†Œ
        const lpDisk = document.getElementById('lp-disk');
        const btnPlay = document.getElementById('btn-play');
        const iconPlay = document.getElementById('icon-play');
        const iconPause = document.getElementById('icon-pause');
        const progressFill = document.getElementById('progress-fill');
        const progressHandle = document.getElementById('progress-handle');
        const seekSlider = document.getElementById('seek-slider');
        const timeCurr = document.getElementById('current-time');
        const timeDur = document.getElementById('duration');
        const errorBox = document.getElementById('error-box');
        const playerBgImage = document.getElementById('player-bg-image');

        // ==================== ì´ˆê¸°í™” ====================
        function init() {
            renderSongList();
            loadSongData(0); 
        }

        // ==================== 1. í™ˆ í™”ë©´ ë¡œì§ ====================
        function renderSongList() {
            songList.innerHTML = '';
            songs.forEach((song, index) => {
                const div = document.createElement('div');
                div.className = "flex items-center gap-4 p-3 rounded-xl hover:bg-white/10 active:scale-98 transition-all cursor-pointer group";
                div.innerHTML = `
                    <div class="w-12 h-12 rounded-lg bg-gray-800 overflow-hidden relative flex-shrink-0">
                        <img src="${song.cover}" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-black/40 hidden group-hover:flex items-center justify-center">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="white"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <h3 class="text-base font-bold text-white truncate">${song.title}</h3>
                        <p class="text-xs text-gray-400 truncate">${song.artist}</p>
                    </div>
                    <button class="text-gray-500 hover:text-white">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
                    </button>
                `;
                div.onclick = () => openPlayer(index);
                songList.appendChild(div);
            });
        }

        // ==================== 2. ë°ì´í„° ë¡œë“œ & UI ì—…ë°ì´íŠ¸ ====================
        function loadSongData(index) {
            const song = songs[index];
            audio.src = song.src;
            
            // ì „ì²´ í”Œë ˆì´ì–´ ì—…ë°ì´íŠ¸
            document.getElementById('song-title').innerText = song.title;
            document.getElementById('song-artist').innerText = song.artist;
            document.getElementById('cover-image').src = song.cover;
            playerBgImage.src = song.cover;
            
            // ë¯¸ë‹ˆ í”Œë ˆì´ì–´ ì—…ë°ì´íŠ¸
            miniTitle.innerText = song.title;
            miniArtist.innerText = song.artist;
            miniCover.src = song.cover;

            errorBox.classList.add('hidden');
        }

        // ==================== 3. í”Œë ˆì´ì–´ ì œì–´ ====================
        function openPlayer(index) {
            // ê°™ì€ ê³¡ì„ ëˆ„ë¥´ë©´ í”Œë ˆì´ì–´ë§Œ ì¼¬
            if (currentIdx === index) {
                playerScreen.classList.remove('translate-y-full');
                return;
            }

            // ë‹¤ë¥¸ ê³¡ì´ë©´ ë¡œë“œí•˜ê³  ì¬ìƒ
            currentIdx = index;
            loadSongData(index);
            playerScreen.classList.remove('translate-y-full');
            
            // ë¯¸ë‹ˆ í”Œë ˆì´ì–´ í‘œì‹œ
            miniPlayer.classList.remove('translate-y-full');

            setTimeout(() => {
                playMusic();
            }, 300);
        }

        document.getElementById('btn-minimize').onclick = () => {
            playerScreen.classList.add('translate-y-full');
            // ë¯¸ë‹ˆ í”Œë ˆì´ì–´ëŠ” ê³„ì† ë³´ì—¬ì•¼ í•¨
            miniPlayer.classList.remove('translate-y-full');
        };

        function playMusic() {
            const playPromise = audio.play();
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    updateUI(true);
                }).catch(e => {
                    console.error(e);
                    errorBox.classList.remove('hidden');
                    updateUI(false);
                });
            }
        }

        function pauseMusic() {
            audio.pause();
            updateUI(false);
        }

        function togglePlay() {
            if (audio.paused) playMusic();
            else pauseMusic();
        }

        function updateUI(playing) {
            isPlaying = playing;
            
            // ì „ì²´ í™”ë©´ UI
            if (playing) {
                iconPlay.classList.add('hidden');
                iconPause.classList.remove('hidden');
                lpDisk.classList.add('spinning');
            } else {
                iconPlay.classList.remove('hidden');
                iconPause.classList.add('hidden');
                lpDisk.classList.remove('spinning');
            }

            // ë¯¸ë‹ˆ í”Œë ˆì´ì–´ UI
            if (playing) {
                miniIconPlay.classList.add('hidden');
                miniIconPause.classList.remove('hidden');
            } else {
                miniIconPlay.classList.remove('hidden');
                miniIconPause.classList.add('hidden');
            }
        }

        // ë‹¤ìŒ ê³¡ / ì´ì „ ê³¡
        function playNext() {
            currentIdx = (currentIdx + 1) % songs.length;
            loadSongData(currentIdx);
            playMusic();
        }
        
        function playPrev() {
            currentIdx = (currentIdx - 1 + songs.length) % songs.length;
            loadSongData(currentIdx);
            playMusic();
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        btnPlay.onclick = togglePlay;
        document.getElementById('btn-next').onclick = playNext;
        document.getElementById('btn-prev').onclick = playPrev;
        audio.addEventListener('ended', playNext);

        // ì§„í–‰ ë°” ì—…ë°ì´íŠ¸
        audio.addEventListener('timeupdate', () => {
            const { currentTime, duration } = audio;
            if (isNaN(duration)) return;
            const percent = (currentTime / duration) * 100;
            
            // ì „ì²´ í™”ë©´ ë°”
            progressFill.style.width = `${percent}%`;
            if(progressHandle) progressHandle.style.left = `${percent}%`;
            seekSlider.value = percent;
            timeCurr.innerText = formatTime(currentTime);
            timeDur.innerText = formatTime(duration);

            // ë¯¸ë‹ˆ í”Œë ˆì´ì–´ ë°”
            miniProgress.style.width = `${percent}%`;
        });

        seekSlider.addEventListener('input', (e) => {
            const time = (e.target.value / 100) * audio.duration;
            audio.currentTime = time;
        });

        function formatTime(s) {
            if(isNaN(s)) return "00:00";
            const min = Math.floor(s / 60);
            const sec = Math.floor(s % 60);
            return `${min}:${sec < 10 ? '0'+sec : sec}`;
        }

        // ì•± ì‹œì‘
        init();

    </script>
</body>
</html>