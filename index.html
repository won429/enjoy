<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>엔쪽이 뮤직 플레이어</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { 
            font-family: 'Pretendard', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            background-color: #030712;
        }
        
        /* LP 회전 애니메이션 */
        @keyframes spin-lp {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .spinning {
            animation: spin-lp 10s linear infinite;
        }
        
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        /* 화면 전환 애니메이션 */
        .slide-up-enter { transform: translateY(100%); opacity: 0; }
        .slide-up-active { transform: translateY(0); opacity: 1; transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .slide-up-exit { transform: translateY(100%); opacity: 0; transition: all 0.3s ease-in; }
        
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="text-white overflow-hidden select-none h-screen w-screen fixed bg-gray-950">

    <!-- 배경 이미지 (전역 공유) -->
    <div class="absolute inset-0 z-0 pointer-events-none">
        <img id="bg-image" src="./cover.jpg" class="w-full h-full object-cover opacity-20 blur-3xl scale-125 transition-all duration-1000" onerror="this.style.opacity='0'">
        <div class="absolute inset-0 bg-black/50"></div>
    </div>

    <!-- ==================== 1. 홈 화면 (리스트) ==================== -->
    <div id="home-screen" class="relative z-10 h-full flex flex-col p-6 fade-in">
        <!-- 헤더 -->
        <div class="flex justify-between items-center mb-8 mt-2">
            <div class="flex flex-col">
                <span class="text-xs text-white/50 font-bold tracking-widest mb-1">TODAY'S MUSIC</span>
                <h1 class="text-2xl font-bold">My Playlist</h1>
            </div>
            <div class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg>
            </div>
        </div>

        <!-- 노래 리스트 컨테이너 -->
        <div id="song-list" class="flex-1 overflow-y-auto scrollbar-hide space-y-4 pb-20">
            <!-- 자바스크립트로 리스트가 채워집니다 -->
        </div>
    </div>


    <!-- ==================== 2. 플레이어 화면 (숨겨짐) ==================== -->
    <div id="player-screen" class="fixed inset-0 z-20 bg-gray-950/90 backdrop-blur-xl transform translate-y-full transition-transform duration-300 flex flex-col">
        
        <!-- 플레이어 상단바 -->
        <div class="flex justify-between items-center p-6 pt-8">
            <button id="btn-back" class="p-2 rounded-full text-white/50 hover:text-white hover:bg-white/10 transition-all">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
            </button>
            <div class="flex items-center gap-2 px-3 py-1 bg-white/5 rounded-full border border-white/5">
                <div id="status-indicator" class="w-2 h-2 rounded-full bg-white/30 transition-colors duration-300"></div>
                <span class="text-[10px] font-bold tracking-[0.2em] text-white/80">NOW PLAYING</span>
            </div>
            <div class="w-10"></div> <!-- 균형용 공백 -->
        </div>

        <!-- 플레이어 메인 -->
        <div class="flex-1 flex flex-col items-center justify-center px-8 pb-10">
             <!-- 에러 메시지 (숨김) -->
             <div id="error-box" class="hidden bg-red-500/90 text-white text-xs p-3 rounded-xl mb-4 text-center animate-pulse w-full">
                <p>파일을 찾을 수 없습니다.</p>
                <p class="mt-1 opacity-75 text-[10px]">music.mp3 와 cover.jpg 파일이 있는지 확인하세요.</p>
            </div>

            <!-- 앨범 아트 -->
            <div class="relative w-72 h-72 mx-auto mb-12 group">
                <div id="lp-disk" class="w-full h-full rounded-full shadow-[0_10px_40px_rgba(0,0,0,0.6)] border-[8px] border-gray-900 relative bg-gray-900 overflow-hidden">
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-44 h-44 rounded-full overflow-hidden border-4 border-gray-800/50 z-10 bg-gray-800">
                        <img id="cover-image" src="./cover.jpg" class="w-full h-full object-cover opacity-90" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNmZmZmZmYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cmVjdCB4PSIzIiB5Uz0iMyIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiByeD0iMiIgcnk9IjIiPjwvcmVjdD48Y2lyY2xlIGN4PSI4LjUiIGN5PSI4LjUiIHI9IjEuNSI+PC9jaXJjbGU+PHBvbHlsaW5lIHBvaW50cz0iMjEgMTUgMTYgMTAgNSAyMSI+PC9wb2x5bGluZT48L3N2Zz4='">
                    </div>
                    <!-- LP 질감 -->
                    <div class="absolute inset-0 rounded-full border-[2px] border-white/5 pointer-events-none" style="clip-path: circle(45%)"></div>
                    <div class="absolute inset-0 rounded-full border-[2px] border-white/5 pointer-events-none" style="clip-path: circle(35%)"></div>
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-4 h-4 bg-white/80 rounded-full z-20 shadow-lg"></div>
                </div>
            </div>

            <!-- 정보 -->
            <div class="text-center mb-8 w-full">
                <h2 id="song-title" class="text-3xl font-bold text-white mb-2 truncate drop-shadow-lg">빛</h2>
                <p id="song-artist" class="text-white/60 text-sm font-medium uppercase tracking-wider">엔쪽이 OST Part.1</p>
            </div>

            <!-- 진행 바 -->
            <div class="mb-4 w-full px-2">
                <div class="relative h-1.5 bg-white/10 rounded-full cursor-pointer group" id="progress-container">
                    <div id="progress-fill" class="absolute top-0 left-0 h-full bg-white rounded-full transition-all duration-100" style="width: 0%"></div>
                    <input type="range" id="seek-slider" min="0" max="100" value="0" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                </div>
                <div class="flex justify-between text-[10px] text-white/40 mt-2 font-mono tracking-wider">
                    <span id="current-time">00:00</span>
                    <span id="duration">00:00</span>
                </div>
            </div>

            <!-- 컨트롤러 -->
            <div class="mt-auto flex justify-center items-center gap-10 pb-8">
                <button id="btn-prev" class="text-white/40 hover:text-white active:scale-90 transition-all">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="19 20 9 12 19 4 19 20"></polygon><line x1="5" y1="19" x2="5" y2="5"></line></svg>
                </button>
                
                <button id="btn-play" class="w-20 h-20 flex items-center justify-center bg-white text-black rounded-full shadow-[0_0_30px_rgba(255,255,255,0.2)] hover:scale-105 active:scale-95 transition-all">
                    <svg id="icon-play" width="36" height="36" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                    <svg id="icon-pause" class="hidden" width="36" height="36" viewBox="0 0 24 24" fill="currentColor" stroke="none"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
                </button>
                
                <button id="btn-next" class="text-white/40 hover:text-white active:scale-90 transition-all">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg>
                </button>
            </div>
        </div>
    </div>

    <!-- 오디오 태그 -->
    <audio id="audio" playsinline webkit-playsinline></audio>

    <script>
        // ==================== 데이터 ====================
        // ❗ 나중에 노래가 늘어나면 이 목록에 추가만 하면 됩니다!
        const songs = [
            {
                id: 1,
                title: "빛",
                artist: "엔쪽이 OST Part.1",
                src: "./music.mp3", 
                cover: "./cover.jpg"
            }
        ];

        // ==================== 전역 변수 ====================
        let currentIdx = 0;
        let isPlaying = false;

        // ==================== DOM 요소 ====================
        const audio = document.getElementById('audio');
        const homeScreen = document.getElementById('home-screen');
        const songList = document.getElementById('song-list');
        const playerScreen = document.getElementById('player-screen');
        const bgImage = document.getElementById('bg-image');
        
        // 플레이어 내부 요소
        const lpDisk = document.getElementById('lp-disk');
        const statusDot = document.getElementById('status-indicator');
        const btnPlay = document.getElementById('btn-play');
        const iconPlay = document.getElementById('icon-play');
        const iconPause = document.getElementById('icon-pause');
        const progressFill = document.getElementById('progress-fill');
        const seekSlider = document.getElementById('seek-slider');
        const timeCurr = document.getElementById('current-time');
        const timeDur = document.getElementById('duration');
        const errorBox = document.getElementById('error-box');

        // ==================== 초기화 ====================
        function init() {
            renderSongList();
            // 초기값은 첫 번째 곡으로 세팅
            loadSongData(0); 
        }

        // ==================== 1. 홈 화면 로직 ====================
        function renderSongList() {
            songList.innerHTML = '';
            songs.forEach((song, index) => {
                const div = document.createElement('div');
                div.className = "flex items-center gap-4 p-4 bg-white/5 rounded-2xl border border-white/5 active:scale-98 transition-transform cursor-pointer hover:bg-white/10";
                div.innerHTML = `
                    <div class="w-16 h-16 rounded-xl bg-gray-800 overflow-hidden shadow-lg relative">
                        <img src="${song.cover}" class="w-full h-full object-cover" onerror="this.style.display='none'">
                        <div class="absolute inset-0 bg-black/20"></div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <h3 class="text-lg font-bold text-white truncate">${song.title}</h3>
                        <p class="text-sm text-white/50 truncate">${song.artist}</p>
                    </div>
                `;
                div.onclick = () => openPlayer(index);
                songList.appendChild(div);
            });
        }

        // ==================== 2. 플레이어 로직 ====================
        
        // 플레이어 열기 (노래 선택 시)
        function openPlayer(index) {
            currentIdx = index;
            loadSongData(index);
            
            // 화면 전환
            playerScreen.classList.remove('translate-y-full');
            
            // 약간의 딜레이 후 재생 (애니메이션 부드럽게)
            setTimeout(() => {
                playMusic();
            }, 300);
        }

        // 플레이어 닫기 (뒤로가기)
        document.getElementById('btn-back').onclick = () => {
            playerScreen.classList.add('translate-y-full');
            // 뒤로 가도 음악은 계속 재생되게 둘까요? 
            // 보통은 끄지 않습니다. 원하시면 pauseMusic() 추가하세요.
        };

        function loadSongData(index) {
            const song = songs[index];
            audio.src = song.src;
            
            // 텍스트 & 이미지 업데이트
            document.getElementById('song-title').innerText = song.title;
            document.getElementById('song-artist').innerText = song.artist;
            document.getElementById('cover-image').src = song.cover;
            bgImage.src = song.cover;
            
            errorBox.classList.add('hidden');
        }

        function playMusic() {
            const playPromise = audio.play();
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    updateUI(true);
                }).catch(e => {
                    console.error(e);
                    errorBox.classList.remove('hidden');
                    updateUI(false);
                });
            }
        }

        function pauseMusic() {
            audio.pause();
            updateUI(false);
        }

        function togglePlay() {
            if (audio.paused) playMusic();
            else pauseMusic();
        }

        function updateUI(playing) {
            isPlaying = playing;
            if (playing) {
                iconPlay.classList.add('hidden');
                iconPause.classList.remove('hidden');
                lpDisk.classList.add('spinning');
                statusDot.classList.replace('bg-white/30', 'bg-green-400');
            } else {
                iconPlay.classList.remove('hidden');
                iconPause.classList.add('hidden');
                lpDisk.classList.remove('spinning');
                statusDot.classList.replace('bg-green-400', 'bg-white/30');
            }
        }

        // 다음 곡 / 이전 곡
        function playNext() {
            currentIdx = (currentIdx + 1) % songs.length;
            loadSongData(currentIdx);
            playMusic();
        }
        
        function playPrev() {
            currentIdx = (currentIdx - 1 + songs.length) % songs.length;
            loadSongData(currentIdx);
            playMusic();
        }

        // 이벤트 리스너
        btnPlay.onclick = togglePlay;
        document.getElementById('btn-next').onclick = playNext;
        document.getElementById('btn-prev').onclick = playPrev;
        audio.addEventListener('ended', playNext);

        // 진행 바 업데이트
        audio.addEventListener('timeupdate', () => {
            const { currentTime, duration } = audio;
            if (isNaN(duration)) return;
            const percent = (currentTime / duration) * 100;
            progressFill.style.width = `${percent}%`;
            seekSlider.value = percent;
            timeCurr.innerText = formatTime(currentTime);
            timeDur.innerText = formatTime(duration);
        });

        seekSlider.addEventListener('input', (e) => {
            const time = (e.target.value / 100) * audio.duration;
            audio.currentTime = time;
        });

        function formatTime(s) {
            if(isNaN(s)) return "00:00";
            const min = Math.floor(s / 60);
            const sec = Math.floor(s % 60);
            return `${min}:${sec < 10 ? '0'+sec : sec}`;
        }

        // 앱 시작
        init();

    </script>
</body>
</html>