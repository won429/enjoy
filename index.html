<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—”ìª½ì´ ë®¤ì§ í”Œë ˆì´ì–´</title>
    <!-- í…Œì¼ìœˆë“œ CSS (ë””ìì¸ ë„êµ¬) - ì—¬ì „íˆ í•„ìš”í•˜ì§€ë§Œ ê°€ë³ê²Œ ë¡œë“œë©ë‹ˆë‹¤ -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { font-family: 'Pretendard', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        /* LP íšŒì „ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes spin-lp {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-spin-lp {
            animation: spin-lp 10s linear infinite;
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        /* ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ */
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="bg-gray-950 text-white overflow-hidden select-none touch-manipulation">

    <!-- ë°°ê²½ ë¸”ëŸ¬ íš¨ê³¼ -->
    <div class="absolute inset-0 z-0">
        <img id="bg-image" src="https://files.catbox.moe/gcuicg.jpg" alt="bg" class="w-full h-full object-cover opacity-30 blur-3xl scale-125 transition-all duration-1000">
        <div class="absolute inset-0 bg-black/40"></div>
    </div>

    <div class="min-h-screen flex items-center justify-center p-6 relative z-10">
        <div class="bg-white/5 backdrop-blur-2xl border border-white/10 p-8 rounded-[40px] shadow-2xl w-full max-w-md overflow-hidden flex flex-col min-h-[640px]">
            
            <!-- ìƒë‹¨ í—¤ë” -->
            <div class="flex justify-between items-center mb-8 relative">
                <div class="w-10"></div> <!-- ê· í˜•ìš© ë¹ˆê³µê°„ -->
                
                <div class="flex items-center gap-2 px-4 py-1 bg-white/5 rounded-full border border-white/5">
                    <span id="status-dot" class="w-2 h-2 rounded-full bg-white/30"></span>
                    <span class="text-[10px] font-bold tracking-[0.2em] text-white/80">NOW PLAYING</span>
                </div>
                
                <button id="playlist-btn" class="p-2 rounded-full text-white/40 hover:text-white hover:bg-white/5 transition-colors">
                    <!-- ListMusic Icon -->
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15V6"></path><path d="M18.5 18a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z"></path><path d="M12 12H3"></path><path d="M16 6H3"></path><path d="M12 18H3"></path></svg>
                </button>
            </div>

            <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
            <div id="error-msg" class="hidden bg-red-500/90 text-white text-xs p-3 rounded-xl mb-4 flex items-center gap-2 justify-center animate-bounce">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                <span id="error-text"></span>
            </div>

            <!-- ë©”ì¸ í”Œë ˆì´ì–´ í™”ë©´ -->
            <div id="main-view" class="flex-1 flex flex-col fade-in">
                <!-- ì•¨ë²” ì•„íŠ¸ -->
                <div class="relative w-72 h-72 mx-auto mb-10 group">
                    <div id="album-art-container" class="w-full h-full rounded-full shadow-[0_10px_40px_rgba(0,0,0,0.5)] border-8 border-gray-900 overflow-hidden relative bg-gray-900">   
                        <!-- ì»¤ë²„ ì´ë¯¸ì§€ -->
                        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-40 h-40 rounded-full overflow-hidden border-4 border-gray-800/50 z-10">
                            <img id="cover-image" src="https://files.catbox.moe/gcuicg.jpg" alt="Album Art" class="w-full h-full object-cover opacity-90">
                        </div>
                        <!-- LP íš¨ê³¼ -->
                        <div class="absolute inset-0 rounded-full bg-[conic-gradient(from_0deg,rgba(255,255,255,0.1),rgba(255,255,255,0.05),rgba(255,255,255,0.1))] pointer-events-none"></div>
                        <div class="absolute inset-0 rounded-full border-[2px] border-white/5 pointer-events-none" style="clip-path: circle(48%)"></div>
                        <div class="absolute inset-0 rounded-full border-[2px] border-white/5 pointer-events-none" style="clip-path: circle(40%)"></div>
                        <div class="absolute inset-0 rounded-full border-[2px] border-white/5 pointer-events-none" style="clip-path: circle(32%)"></div>
                        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-4 h-4 bg-white/80 rounded-full border-2 border-gray-400 shadow-inner z-20"></div>
                    </div>

                    <!-- ì¬ìƒ ì˜¤ë²„ë ˆì´ ë²„íŠ¼ -->
                    <div id="overlay-play-btn" class="absolute inset-0 flex items-center justify-center z-30 cursor-pointer">
                        <div class="w-20 h-20 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center hover:bg-white/30 transition-all hover:scale-105">
                            <svg width="36" height="36" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        </div>
                    </div>
                </div>

                <!-- ê³¡ ì •ë³´ -->
                <div class="text-center mb-8 px-4">
                    <h2 id="song-title" class="text-2xl font-bold text-white mb-2 truncate drop-shadow-md tracking-tight">ë¹›</h2>
                    <p id="song-artist" class="text-white/50 text-sm font-medium tracking-wide uppercase">ì—”ìª½ì´ OST Part.1</p>
                </div>

                <!-- ì§„í–‰ ë°” -->
                <div class="mb-4 px-2">
                    <div class="flex justify-between text-[10px] text-white/40 mb-2 font-mono tracking-wider">
                        <span id="current-time">00:00</span>
                        <span id="duration">00:00</span>
                    </div>
                    <div id="progress-container" class="relative h-1.5 bg-white/10 rounded-full cursor-pointer group py-2">
                        <div class="absolute top-1/2 -translate-y-1/2 left-0 right-0 h-1.5 bg-white/10 rounded-full overflow-hidden">
                            <div id="progress-bar" class="h-full bg-white rounded-full shadow-[0_0_10px_rgba(255,255,255,0.5)]" style="width: 0%"></div>
                        </div>
                        <div id="progress-handle" class="absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-white rounded-full shadow opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none" style="left: 0%"></div>
                        <!-- ì‹¤ì œ í´ë¦­ ì˜ì—­ -->
                        <input type="range" id="seek-slider" min="0" max="100" value="0" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                    </div>
                </div>
            </div>

            <!-- ì¬ìƒëª©ë¡ í™”ë©´ (ìˆ¨ê¹€ ìƒíƒœ) -->
            <div id="playlist-view" class="hidden flex-1 overflow-y-auto mb-6 pr-2 scrollbar-hide fade-in">
                <h3 class="text-white/90 text-lg font-bold mb-6 px-2 flex items-center gap-2">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15V6"></path><path d="M18.5 18a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z"></path><path d="M12 12H3"></path><path d="M16 6H3"></path><path d="M12 18H3"></path></svg>
                    Playlist
                </h3>
                <div id="playlist-items" class="space-y-3">
                    <!-- JSë¡œ ì±„ì›Œì§ -->
                </div>
            </div>

            <!-- í•˜ë‹¨ ì»¨íŠ¸ë¡¤ ë°” -->
            <div class="mt-auto pt-6 border-t border-white/5 flex items-center justify-center relative">
                <div class="flex items-center justify-center gap-8">
                    <button id="prev-btn" class="text-white/40 hover:text-white transition-colors active:scale-90">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="19 20 9 12 19 4 19 20"></polygon><line x1="5" y1="19" x2="5" y2="5"></line></svg>
                    </button>
                    
                    <button id="play-pause-btn" class="w-16 h-16 flex items-center justify-center bg-white text-black rounded-full shadow-[0_0_20px_rgba(255,255,255,0.3)] hover:scale-105 hover:shadow-[0_0_30px_rgba(255,255,255,0.5)] transition-all active:scale-95 active:shadow-none">
                        <!-- ì•„ì´ì½˜ì€ JSë¡œ êµì²´ë¨ -->
                        <svg id="play-icon" width="32" height="32" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        <svg id="pause-icon" class="hidden" width="32" height="32" viewBox="0 0 24 24" fill="currentColor" stroke="none"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
                    </button>
                    
                    <button id="next-btn" class="text-white/40 hover:text-white transition-colors active:scale-90">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg>
                    </button>
                </div>
            </div>

            <!-- ì˜¤ë””ì˜¤ íƒœê·¸ (ëª¨ë°”ì¼ í˜¸í™˜ì„± ìµœì í™”) -->
            <audio id="audio-player" preload="auto" playsinline webkit-playsinline></audio>
        </div>
    </div>

    <!-- ìˆœìˆ˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ -->
    <script>
        // ğŸµ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë°ì´í„°
        const playlist = [
            {
                id: 1,
                title: "ë¹›",
                artist: "ì—”ìª½ì´ OST Part.1",
                src: "https://files.catbox.moe/77ewj6.mp3",
                cover: "https://files.catbox.moe/gcuicg.jpg"
            }
        ];

        // ìƒíƒœ ë³€ìˆ˜
        let currentSongIndex = 0;
        let isPlaying = false;
        let isPlaylistVisible = false;

        // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const audio = document.getElementById('audio-player');
        const bgImage = document.getElementById('bg-image');
        const coverImage = document.getElementById('cover-image');
        const songTitle = document.getElementById('song-title');
        const songArtist = document.getElementById('song-artist');
        const albumContainer = document.getElementById('album-art-container');
        const overlayPlayBtn = document.getElementById('overlay-play-btn');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const statusDot = document.getElementById('status-dot');
        const progressBar = document.getElementById('progress-bar');
        const progressHandle = document.getElementById('progress-handle');
        const seekSlider = document.getElementById('seek-slider');
        const currentTimeEl = document.getElementById('current-time');
        const durationEl = document.getElementById('duration');
        const mainView = document.getElementById('main-view');
        const playlistView = document.getElementById('playlist-view');
        const playlistBtn = document.getElementById('playlist-btn');
        const playlistItems = document.getElementById('playlist-items');
        const errorMsg = document.getElementById('error-msg');
        const errorText = document.getElementById('error-text');

        // ì´ˆê¸°í™”
        function loadSong(index) {
            const song = playlist[index];
            audio.src = song.src;
            // í°ì—ì„œëŠ” load()ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•˜ëŠ” ê²Œ ì•ˆì „í•¨
            audio.load();
            
            songTitle.innerText = song.title;
            songArtist.innerText = song.artist;
            coverImage.src = song.cover;
            bgImage.src = song.cover;
            
            updatePlaylistUI();
            errorMsg.classList.add('hidden');
        }

        // ì¬ìƒ/ì¼ì‹œì •ì§€ í† ê¸€
        function togglePlay() {
            if (audio.paused) {
                const playPromise = audio.play();
                if (playPromise !== undefined) {
                    playPromise
                        .then(() => {
                            setIsPlayingUI(true);
                        })
                        .catch(error => {
                            console.error("ì¬ìƒ ì‹¤íŒ¨:", error);
                            showError("ì¬ìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ëª¨ë°”ì¼ ì •ì±… ë˜ëŠ” ë§í¬ í™•ì¸)");
                            setIsPlayingUI(false);
                        });
                }
            } else {
                audio.pause();
                setIsPlayingUI(false);
            }
        }

        // UI ìƒíƒœ ì—…ë°ì´íŠ¸
        function setIsPlayingUI(playing) {
            isPlaying = playing;
            if (playing) {
                playIcon.classList.add('hidden');
                pauseIcon.classList.remove('hidden');
                overlayPlayBtn.classList.add('hidden');
                albumContainer.classList.add('animate-spin-lp');
                statusDot.classList.replace('bg-white/30', 'bg-green-400');
                statusDot.classList.add('animate-pulse');
            } else {
                playIcon.classList.remove('hidden');
                pauseIcon.classList.add('hidden');
                overlayPlayBtn.classList.remove('hidden');
                albumContainer.classList.remove('animate-spin-lp');
                // íšŒì „ ë©ˆì¶œ ë•Œ ìœ„ì¹˜ ìœ ì§€í•˜ê³  ì‹¶ìœ¼ë©´ animation-play-stateë¥¼ ì¨ì•¼í•˜ì§€ë§Œ, ê°„ë‹¨íˆ í´ë˜ìŠ¤ ì œê±°ë¡œ ì²˜ë¦¬
                statusDot.classList.replace('bg-green-400', 'bg-white/30');
                statusDot.classList.remove('animate-pulse');
            }
        }

        // ì´ì „/ë‹¤ìŒ ê³¡
        function playNext() {
            currentSongIndex = (currentSongIndex + 1) % playlist.length;
            loadSong(currentSongIndex);
            togglePlay();
        }

        function playPrev() {
            currentSongIndex = (currentSongIndex - 1 + playlist.length) % playlist.length;
            loadSong(currentSongIndex);
            togglePlay();
        }

        // ì§„í–‰ ë°” ì—…ë°ì´íŠ¸
        function updateProgress() {
            const { duration, currentTime } = audio;
            if (isNaN(duration)) return;
            
            const progressPercent = (currentTime / duration) * 100;
            progressBar.style.width = `${progressPercent}%`;
            progressHandle.style.left = `${progressPercent}%`;
            seekSlider.value = progressPercent;
            
            currentTimeEl.innerText = formatTime(currentTime);
            durationEl.innerText = formatTime(duration);
        }

        function setProgress(e) {
            const width = this.clientWidth;
            const clickX = e.offsetX; // ë§ˆìš°ìŠ¤ í´ë¦­ìš©
            // range input ê°’ì´ ë³€ê²½ë˜ì—ˆì„ ë•Œ ì²˜ë¦¬
            const duration = audio.duration;
            if(audio.duration) {
                audio.currentTime = (seekSlider.value / 100) * duration;
            }
        }

        function formatTime(time) {
            if (isNaN(time)) return "00:00";
            const minutes = Math.floor(time / 60);
            const seconds = Math.floor(time % 60);
            return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }

        function showError(msg) {
            errorText.innerText = msg;
            errorMsg.classList.remove('hidden');
        }

        // í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ UI ìƒì„±
        function updatePlaylistUI() {
            playlistItems.innerHTML = '';
            playlist.forEach((song, index) => {
                const div = document.createElement('div');
                const isActive = index === currentSongIndex;
                div.className = `flex items-center gap-4 p-4 rounded-2xl cursor-pointer transition-all ${isActive ? 'bg-white/10 border border-white/10' : 'hover:bg-white/5 border border-transparent'}`;
                div.onclick = () => {
                    currentSongIndex = index;
                    loadSong(index);
                    togglePlay();
                    togglePlaylistView(); // ì„ íƒ í›„ ë©”ì¸ìœ¼ë¡œ ë³µê·€
                };
                
                div.innerHTML = `
                    <div class="relative w-12 h-12 rounded-lg overflow-hidden flex-shrink-0 bg-gray-800 shadow-lg">
                        <img src="${song.cover}" class="w-full h-full object-cover">
                        ${isActive && isPlaying ? '<div class="absolute inset-0 bg-black/40 flex items-center justify-center"><div class="w-1.5 h-1.5 bg-white rounded-full animate-ping"></div></div>' : ''}
                    </div>
                    <div class="flex-1 min-w-0">
                        <h4 class="text-sm font-bold truncate ${isActive ? 'text-white' : 'text-white/70'}">${song.title}</h4>
                        <p class="text-xs text-white/40 truncate mt-1">${song.artist}</p>
                    </div>
                `;
                playlistItems.appendChild(div);
            });
        }

        function togglePlaylistView() {
            isPlaylistVisible = !isPlaylistVisible;
            if (isPlaylistVisible) {
                mainView.classList.add('hidden');
                playlistView.classList.remove('hidden');
                playlistBtn.classList.add('bg-white', 'text-black', 'shadow-lg');
                playlistBtn.classList.remove('text-white/40', 'hover:text-white', 'hover:bg-white/5');
            } else {
                mainView.classList.remove('hidden');
                playlistView.classList.add('hidden');
                playlistBtn.classList.remove('bg-white', 'text-black', 'shadow-lg');
                playlistBtn.classList.add('text-white/40', 'hover:text-white', 'hover:bg-white/5');
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        playPauseBtn.addEventListener('click', togglePlay);
        overlayPlayBtn.addEventListener('click', togglePlay);
        document.getElementById('next-btn').addEventListener('click', playNext);
        document.getElementById('prev-btn').addEventListener('click', playPrev);
        playlistBtn.addEventListener('click', togglePlaylistView);
        
        audio.addEventListener('timeupdate', updateProgress);
        audio.addEventListener('ended', playNext);
        audio.addEventListener('play', () => setIsPlayingUI(true));
        audio.addEventListener('pause', () => setIsPlayingUI(false));
        
        // ìŠ¬ë¼ì´ë” ì¡°ì‘
        seekSlider.addEventListener('input', () => {
             const duration = audio.duration;
             if(duration) {
                // ë“œë˜ê·¸ ì¤‘ ì‹œê°„ í‘œì‹œ ì—…ë°ì´íŠ¸
                const val = seekSlider.value;
                progressBar.style.width = `${val}%`;
                progressHandle.style.left = `${val}%`;
                currentTimeEl.innerText = formatTime((val / 100) * duration);
             }
        });
        seekSlider.addEventListener('change', () => {
             const duration = audio.duration;
             if(duration) {
                audio.currentTime = (seekSlider.value / 100) * duration;
             }
        });

        // ì´ˆê¸° ì‹¤í–‰
        loadSong(currentSongIndex);

    </script>
</body>
</html>