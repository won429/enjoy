<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Play enjoy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- í°íŠ¸ ì¶”ê°€: í•™êµì•ˆì‹¬ ë‘¥ê·¼ë¯¸ì†Œ (ë¡œê³ ìš©) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonts-archive/HakgyoansimDunggeunmiso/HakgyoansimDunggeunmiso.css" type="text/css"/>
    
    <style>
        /* í°íŠ¸ ì¶”ê°€: Gë§ˆì¼“ ì‚°ìŠ¤ (ë³¸ë¬¸ìš©) */
        @font-face {
            font-family: 'GmarketSansMedium';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        /* ê¸°ë³¸ í°íŠ¸ ì„¤ì • */
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        
        body { 
            /* Gë§ˆì¼“ ì‚°ìŠ¤ë¥¼ ìµœìš°ì„ ìœ¼ë¡œ ì ìš© */
            font-family: 'GmarketSansMedium', -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo", "Pretendard", Roboto, "Noto Sans KR", sans-serif;
            -webkit-tap-highlight-color: transparent;
            background-color: #ffffff; /* ë°°ê²½ í°ìƒ‰ */
        }
        
        /* ë¡œê³  ì „ìš© í°íŠ¸ */
        .font-logo {
            font-family: 'Hakgyoansim Dunggeunmiso', sans-serif;
            font-weight: 700; 
        }
        
        /* LP íšŒì „ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes spin-lp {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .lp-animation {
            animation: spin-lp 10s linear infinite;
            animation-play-state: paused; /* ê¸°ë³¸ ë©ˆì¶¤ */
        }
        .lp-animation.running {
            animation-play-state: running; /* ì¬ìƒ ì‹œ íšŒì „ */
        }
        
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .pb-safe { padding-bottom: env(safe-area-inset-bottom, 20px); }
        
        /* ì¬ìƒë°” íŠ¸ëœì§€ì…˜ */
        .smooth-transition { transition: width 0.1s linear, left 0.1s linear; }
        .no-transition { transition: none !important; }

        /* ìŠ¬ë¼ì´ë” ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì œê±° */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            box-shadow: none;
            border: none;
        }

        /* ì¸íŠ¸ë¡œ í˜ì´ë“œ ì•„ì›ƒ */
        .fade-out {
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.8s ease-out, visibility 0.8s;
        }
        
        /* LP ì§ˆê° */
        .lp-texture {
            background: repeating-radial-gradient(
                #111 0, 
                #111 2px, 
                #1a1a1a 3px, 
                #111 4px
            );
        }

        /* â¤ï¸ í•˜íŠ¸ ë‚ ì•„ê°€ëŠ” íš¨ê³¼ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes flyUpHeart {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            50% { opacity: 1; }
            100% { transform: translate(-50%, -50%) translateY(-60px) scale(1.5); opacity: 0; }
        }
        @keyframes returnHeart {
            0% { transform: translate(-50%, -50%) translateY(-60px) scale(1.5); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translate(-50%, -50%) translateY(0) scale(1); opacity: 0; } 
        }
        
        .heart-effect {
            position: fixed;
            z-index: 9999;
            pointer-events: none;
            color: #005ED2; 
        }
        .anim-fly-up { animation: flyUpHeart 0.8s ease-out forwards; }
        .anim-return { animation: returnHeart 0.6s ease-in forwards; }
    </style>
</head>
<body class="text-black overflow-hidden select-none h-[100dvh] w-screen fixed bg-white">

    <!-- ==================== 0. ì¸íŠ¸ë¡œ í™”ë©´ (ì´ë¯¸ì§€ ë²„ì „) ==================== -->
    <div id="boot-screen" class="fixed inset-0 z-[100] bg-white flex items-center justify-center cursor-pointer transition-opacity duration-1000">
        <!-- intro.jpg ì´ë¯¸ì§€ê°€ í™”ë©´ì— ê½‰ ì°¨ê²Œ í‘œì‹œë©ë‹ˆë‹¤ -->
        <img src="./intro.jpg" class="w-full h-full object-cover animate-pulse" onerror="this.style.display='none'; document.getElementById('intro-fallback').classList.remove('hidden');">
        
        <!-- ì´ë¯¸ì§€ê°€ ì—†ì„ ê²½ìš° ë³´ì—¬ì¤„ ëŒ€ì²´ í™”ë©´ -->
        <div id="intro-fallback" class="hidden flex flex-col items-center gap-4">
             <div class="text-[#005ED2] flex items-center justify-center scale-150 mb-2">
                <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M5 10v4"></path>
                    <path d="M9 7v10"></path>
                    <path d="M13 4v16"></path>
                    <path d="M17 8v8"></path>
                    <path d="M21 11v2"></path>
                </svg>
             </div>
             <h1 class="font-logo tracking-tight text-black text-4xl lowercase">Play enjoy</h1>
             <p class="text-gray-400 text-xs">í™”ë©´ì„ í„°ì¹˜í•˜ì„¸ìš”</p>
        </div>
    </div>

    <!-- ==================== íŒì—… (ëª¨ë‹¬) ==================== -->
    <div id="popup-modal" class="fixed inset-0 z-[60] bg-black/30 backdrop-blur-sm hidden flex items-center justify-center px-6">
        <div class="bg-white rounded-2xl p-6 w-full max-w-xs text-center shadow-2xl border border-gray-100 scale-in">
            <div class="w-12 h-12 bg-[#005ED2]/10 rounded-full flex items-center justify-center mx-auto mb-4 text-[#005ED2]">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
            </div>
            <h3 class="text-lg font-bold text-black mb-2">Coming Soon</h3>
            <p class="text-gray-500 text-sm mb-6">ì´ ê³¡ì€ ê³§ ê³µê°œë  ì˜ˆì •ì…ë‹ˆë‹¤.<br>ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!</p>
            <button id="popup-close" class="w-full bg-gray-900 text-white font-bold py-3 rounded-xl hover:bg-gray-800 transition-colors">
                ë‹«ê¸°
            </button>
        </div>
    </div>

    <!-- ==================== ì „ì²´ ì°¨íŠ¸ ë·° (ë”ë³´ê¸° - í°ìƒ‰ í…Œë§ˆ) ==================== -->
    <div id="full-chart-view" class="fixed inset-0 z-[80] bg-white transform translate-x-full transition-transform duration-300 flex flex-col h-[100dvh] pb-32">
        <div class="px-6 pt-8 pb-4 flex items-center gap-4 bg-white/95 backdrop-blur-md sticky top-0 z-10 border-b border-gray-100">
            <button id="btn-close-chart" class="p-2 -ml-2 rounded-full text-black hover:bg-gray-100 transition-colors">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
            </button>
            <h2 class="text-xl font-bold text-black">ì‹¤ì‹œê°„ ì°¨íŠ¸ TOP 100</h2>
        </div>
        <div id="full-chart-list" class="flex-1 overflow-y-auto px-6 space-y-1">
            <!-- ì „ì²´ ë¦¬ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
        </div>
    </div>

    <!-- ==================== 1. í™ˆ í™”ë©´ ==================== -->
    <div id="home-screen" class="relative z-10 h-full flex flex-col opacity-0 transition-opacity duration-1000">
        
        <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="px-6 pt-8 pb-4 flex justify-between items-center">
            <div class="flex items-center gap-2"> 
                <div class="text-[#005ED2] flex items-center justify-center">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M5 10v4"></path>
                        <path d="M9 7v10"></path>
                        <path d="M13 4v16"></path>
                        <path d="M17 8v8"></path>
                        <path d="M21 11v2"></path>
                    </svg>
                </div>
                <h1 class="font-logo tracking-tight text-black text-2xl lowercase pt-1">
                    Play enjoy
                </h1>
            </div>
            <div class="w-6"></div>
        </div>

        <!-- ë©”ì¸ ìŠ¤í¬ë¡¤ ì˜ì—­ -->
        <div class="flex-1 overflow-y-auto scrollbar-hide pb-32">
            
            <!-- (1) New Album -->
            <div class="mb-8 pl-6">
                <p class="text-sm text-[#005ED2] font-bold mb-4">New Album</p>
                <div class="flex gap-4 overflow-x-auto scrollbar-hide pr-6" id="new-album-list">
                    <!-- ì—¬ê¸°ì— ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì•¨ë²” ì¹´ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- (2) ì‹¤ì‹œê°„ ì°¨íŠ¸ (ëª¨ë‘ ì¬ìƒ ë²„íŠ¼ ìˆ˜ì •ë¨) -->
            <div class="mb-10">
                <div class="flex justify-between items-center mb-4 px-6">
                    <div class="flex items-center gap-3">
                        <h3 class="text-lg font-bold text-black">ì‹¤ì‹œê°„ ì°¨íŠ¸</h3>
                        <!-- ëª¨ë‘ ì¬ìƒ ë²„íŠ¼ -->
                        <button id="btn-play-all" class="text-[11px] text-[#005ED2] hover:text-white hover:bg-[#005ED2] border border-[#005ED2]/30 font-bold flex items-center gap-1 transition-colors px-2 py-1 rounded-full bg-[#005ED2]/5">
                            <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                            ëª¨ë‘ ì¬ìƒ
                        </button>
                    </div>
                    <button id="btn-more-chart" class="text-xs text-gray-400 hover:text-black font-medium flex items-center gap-1">
                        ë”ë³´ê¸° <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
                    </button>
                </div>
                <!-- ê°€ë¡œ ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ (ìŠ¤ëƒ… ì ìš©) -->
                <div id="chart-slider" class="flex overflow-x-auto snap-x snap-mandatory scrollbar-hide px-6 gap-4">
                    <!-- ì—¬ê¸°ì— 3ê°œì”© ë¬¶ì¸ ìŠ¬ë¼ì´ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- (3) Coming Soon -->
            <div class="pl-6 mb-8">
                <p class="text-sm text-[#005ED2] font-bold mb-4">Coming Soon</p>
                <div class="flex gap-4 overflow-x-auto scrollbar-hide pr-6" id="coming-soon-list"></div>
            </div>
        </div>

        <!-- ğŸ”¥ ë¯¸ë‹ˆ í”Œë ˆì´ì–´ (ë‹¤í¬ í…Œë§ˆ ìœ ì§€) -->
        <div id="mini-player" class="absolute bottom-0 left-0 right-0 bg-[#1E1E1E] border-t border-white/5 px-4 pt-3 pb-safe cursor-pointer translate-y-full transition-transform duration-300 z-20 shadow-[0_-10px_30px_rgba(0,0,0,0.1)]">
            <div class="flex items-center justify-between mb-1 pointer-events-none"> 
                <div class="flex items-center gap-3">
                    <div class="w-11 h-11 rounded-lg overflow-hidden bg-gray-800 relative shadow-inner">
                        <img id="mini-cover" src="./cover.jpg" class="w-full h-full object-cover">
                    </div>
                    <div class="flex flex-col justify-center">
                        <h4 id="mini-title" class="text-sm font-bold text-white truncate max-w-[150px]">ë¹›</h4>
                        <p id="mini-artist" class="text-xs text-gray-400 truncate">ì—”ìª½ì´ OST Part.2</p>
                    </div>
                </div>
                <div class="flex items-center gap-4 pr-2 pointer-events-auto"> 
                    <button id="mini-play-btn" class="w-9 h-9 flex items-center justify-center bg-white text-black rounded-full shadow-md active:scale-90 transition-transform">
                        <svg id="mini-icon-play" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        <svg id="mini-icon-pause" class="hidden" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
                    </button>
                </div>
            </div>
            <!-- ì¬ìƒë°” -->
            <div class="absolute top-0 left-0 right-0 h-[2px] bg-white/10">
                <div id="mini-progress" class="h-full bg-[#005ED2] w-0 transition-all duration-300"></div>
            </div>
        </div>
    </div>


    <!-- ==================== 2. ì „ì²´ í”Œë ˆì´ì–´ í™”ë©´ (ëª°ì…ê° ìœ„í•´ ë‹¤í¬ ìœ ì§€) ==================== -->
    <div id="player-screen" class="fixed inset-0 z-50 bg-[#0a0a0a] transform translate-y-full transition-transform duration-500 flex flex-col h-[100dvh]">
        <!-- í”Œë ˆì´ì–´ìš© ë°°ê²½ -->
        <div class="absolute inset-0 z-0 pointer-events-none overflow-hidden">
             <img id="player-bg-image" src="./cover.jpg" class="w-full h-full object-cover blur-3xl scale-150 brightness-50">
             <div class="bg-noise"></div>
        </div>

        <!-- ìƒë‹¨ë°” -->
        <div class="relative z-10 flex justify-between items-center p-6 pt-10">
            <button id="btn-minimize" class="p-2 rounded-full text-white/70 hover:text-white hover:bg-white/10 transition-all">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
            </button>
            <span class="text-[10px] font-bold tracking-[0.2em] text-white/50">NOW PLAYING</span>
            <button class="p-2 rounded-full text-white/70 hover:text-white hover:bg-white/10 transition-all">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
            </button>
        </div>

        <!-- í”Œë ˆì´ì–´ ë©”ì¸ -->
        <div class="relative z-10 flex-1 flex flex-col items-center justify-center px-8 pb-8 text-white">
             <div id="error-box" class="hidden bg-red-500/90 text-white text-xs p-3 rounded-xl mb-8 text-center animate-pulse w-full max-w-xs">
                <p>íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                <p class="mt-1 opacity-75 text-[10px]">music.mp3 (ë˜ëŠ” music2.mp3) íŒŒì¼ í™•ì¸ í•„ìš”</p>
            </div>

            <div class="relative w-full max-w-[320px] aspect-square mb-auto mt-4 group">
                
                <!-- ğŸ’¿ í†¤ì•” (Tone Arm) -->
                <div id="tone-arm" class="absolute -top-8 -right-4 w-24 h-48 z-20 origin-[70%_15%] transition-transform duration-700 ease-in-out" style="transform: rotate(-25deg);">
                    <svg viewBox="0 0 100 200" class="w-full h-full drop-shadow-2xl">
                        <circle cx="70" cy="30" r="12" fill="#444" stroke="#222" stroke-width="2" />
                        <circle cx="70" cy="30" r="5" fill="#111" />
                        <path d="M70 30 L60 160" stroke="#888" stroke-width="6" stroke-linecap="round" />
                        <rect x="50" y="155" width="20" height="30" rx="4" fill="#333" transform="rotate(1060 170)" />
                        <path d="M58 180 L56 190" stroke="#aaa" stroke-width="2" />
                    </svg>
                </div>

                <!-- ğŸ’¿ LP ë””ìŠ¤í¬ (ì§ˆê° ì¶”ê°€ë¨) -->
                <div id="lp-disk" class="w-full h-full rounded-full shadow-[0_30px_60px_-12px_rgba(0,0,0,0.8)] border-[4px] border-[#1a1a1a] relative bg-[#111] overflow-hidden ring-1 ring-white/10 lp-animation lp-texture">
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[60%] h-[60%] rounded-full overflow-hidden border-4 border-[#222] z-10 bg-gray-800">
                        <img id="cover-image" src="./cover.jpg" class="w-full h-full object-cover opacity-90">
                    </div>
                    <div class="absolute inset-0 bg-gradient-to-tr from-white/10 to-transparent pointer-events-none rounded-full"></div>
                </div>
            </div>

            <div class="w-full mb-8 flex items-end justify-between">
                <div class="flex-1 min-w-0 mr-4">
                    <h2 id="song-title" class="text-2xl font-bold text-white mb-1 truncate scroll-m-0 tracking-tight">ë¹›</h2>
                    <p id="song-artist" class="text-white/60 text-base font-medium truncate">ì—”ìª½ì´ OST Part.2</p>
                </div>
                <!-- â¤ï¸ ì¢‹ì•„ìš” ë²„íŠ¼ -->
                <button id="btn-like" class="text-white/40 hover:text-[#005ED2] transition-all transform active:scale-90 p-2 relative">
                    <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                </button>
            </div>

            <!-- ì§„í–‰ ë°” -->
            <div class="w-full mb-1 relative h-10 flex items-center justify-center" id="progress-container">
                <div class="absolute left-0 right-0 h-1 bg-white/10 rounded-full overflow-hidden pointer-events-none">
                    <div id="progress-fill" class="absolute top-0 left-0 h-full bg-white rounded-full smooth-transition group-hover:bg-[#005ED2]" style="width: 0%"></div>
                </div>
                <div id="progress-handle" class="absolute h-3 w-3 bg-white rounded-full opacity-0 group-hover:opacity-100 smooth-transition pointer-events-none left-0 -ml-[6px]"></div>
                <input type="range" id="seek-slider" min="0" max="100" step="0.1" value="0" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-30" style="touch-action: none;">
            </div>
            
            <!-- ì‹œê°„ í‘œì‹œ -->
            <div class="w-full flex justify-between text-[10px] text-white/40 font-mono font-medium tracking-wider">
                <span id="current-time">00:00</span>
                <span id="duration">00:00</span>
            </div>

            <!-- ì»¨íŠ¸ë¡¤ëŸ¬ -->
            <div class="mt-auto w-full flex justify-between items-center px-4 pb-safe pt-2">
                <!-- ì…”í”Œ -->
                <button class="text-white/30 hover:text-white transition-colors p-2 hover:bg-white/5 rounded-full">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 3 21 3 21 8"></polyline><line x1="4" y1="20" x2="21" y2="3"></line><polyline points="21 16 21 21 16 21"></polyline><line x1="15" y1="15" x2="21" y2="21"></line><line x1="4" y1="4" x2="9" y2="9"></line></svg>
                </button>

                <div class="flex items-center gap-6">
                    <!-- ì´ì „ -->
                    <button id="btn-prev" class="text-white hover:text-[#005ED2] active:scale-90 transition-all p-2">
                        <svg width="36" height="36" viewBox="0 0 24 24" fill="currentColor" stroke="none">
                            <path d="M6 6h2v12H6V6zm3.5 6l8.5 6V6l-8.5 6z"/>
                        </svg>
                    </button>
                    
                    <!-- ì¬ìƒ -->
                    <button id="btn-play" class="w-16 h-16 flex items-center justify-center bg-white text-black rounded-full shadow-[0_0_30px_rgba(255,255,255,0.15)] hover:scale-105 hover:bg-[#005ED2] hover:text-white hover:shadow-[0_0_40px_rgba(0,94,210,0.5)] active:scale-95 transition-all duration-300">
                        <svg id="icon-play" width="32" height="32" viewBox="0 0 24 24" fill="currentColor" stroke="none" class="ml-1"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        <svg id="icon-pause" class="hidden" width="32" height="32" viewBox="0 0 24 24" fill="currentColor" stroke="none"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
                    </button>
                    
                    <!-- ë‹¤ìŒ -->
                    <button id="btn-next" class="text-white hover:text-[#005ED2] active:scale-90 transition-all p-2">
                         <svg width="36" height="36" viewBox="0 0 24 24" fill="currentColor" stroke="none">
                            <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                        </svg>
                    </button>
                </div>

                <!-- ë°˜ë³µ ë²„íŠ¼ -->
                <button id="btn-repeat" class="text-white/30 hover:text-white transition-colors p-2 hover:bg-white/5 rounded-full">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="17 1 21 5 17 9"></polyline><path d="M3 11V9a4 4 0 0 1 4-4h14"></path><polyline points="7 23 3 19 7 15"></polyline><path d="M21 13v2a4 4 0 0 1-4 4H3"></path></svg>
                </button>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì˜¤ë””ì˜¤ -->
    <audio id="audio" playsinline webkit-playsinline></audio>

    <script>
        // ==================== ì•ˆì „í•œ ì‹¤í–‰ ë³´ì¥ ====================
        document.addEventListener('DOMContentLoaded', () => {

            // ğŸµ ì°¨íŠ¸ ìˆœìœ„ ë° ë³€ë™ ìƒíƒœ (rankStatus)
            // status: 'up' (ìƒìŠ¹), 'down' (í•˜ë½), 'new' (ì‹ ê·œ), '-' (ìœ ì§€)
            const songs = [
                { id: 1, title: "ë¹›", artist: "ì—”ìª½ì´ OST Part.2", src: "./music.mp3", cover: "./cover.jpg", rankStatus: '-' }, // 1ìœ„ (ìœ ì§€)
                { id: 2, title: "í˜ë‚´ë¼", artist: "ì—”ìª½ì´ OST Part.1", src: "./music2.mp3", cover: "./cover.jpg", rankStatus: '-' }, // 2ìœ„ (ìœ ì§€)
                { id: 4, title: "ëì—†ëŠ” ì—¬ë¦„ë°¤", artist: "ê·¸ë‚ , ì—”ì¡°ì´ ì´ì•¼ê¸° OST", src: "./music4.mp3", cover: "./cover3.jpg", rankStatus: 'up' }, // 3ìœ„ (ìƒìŠ¹)
                { id: 5, title: "í–‰ë³µì„ ê¿ˆê¾¸ë©° ìš¸ë‹¤", artist: "ì—”ì¡°ì´", src: "./music5.mp3", cover: "./cover4.jpg", rankStatus: 'new' }, // 4ìœ„ (ì‹ ê·œ)
                { id: 6, title: "í„¸ì–´", artist: "ì—”ì¡°ì´", src: "./music6.mp3", cover: "./cover5.jpg", rankStatus: 'new' }, // 5ìœ„ (ì‹ ê·œ)
                { id: 3, title: "ë¹µê¸€ë¹µê¸€ ë¹µê¸€ì†¡", artist: "ì„±ì‹¬ë‹¹", src: "./music3.mp3", cover: "./cover2.jpg", rankStatus: 'down' } // 6ìœ„ (í•˜ë½)
            ];
            
            // ğŸ”œ Coming Soon ëª©ë¡
            const comingSoonSongs = [
                { id: 12, title: "ë„ˆì˜ ëª¨ë“  ìˆœê°„", artist: "í˜„ì‹", cover: "./cover11.jpg" }, 
                { id: 9, title: "ì†Œì£¼í•œì”", artist: "ì´ìƒí›ˆ&ë¥˜ë˜ì™„", cover: "./cover8.jpg" },
                { id: 10, title: "ë…¸ë˜ë°©ì—ì„œ", artist: "í™ì¤€í˜¸", cover: "./cover9.jpg" },
                { id: 11, title: "ë‚˜íŒ”ë°”ì§€", artist: "ì´ìƒí›ˆ, ì´ì§„í˜¸, ë¥˜ë˜ì™„", cover: "./cover10.jpg" },
                { id: 7, title: "ë¯¸ì •", artist: "ì—”ì¡°ì´ ìˆ™ë ¤ ìº í”„ OST", cover: "./cover6.jpg" },
                { id: 8, title: "ë¯¸ì •", artist: "ì¶œì¥ì—”ì¡°ì´ OST", cover: "./cover7.jpg" }
            ];

            let currentIdx = 0;
            let isPlaying = false;
            let isDragging = false; 
            let isLiked = false; 
            let isRepeat = false;

            // DOM ìš”ì†Œ
            const audio = document.getElementById('audio');
            const chartSlider = document.getElementById('chart-slider');
            const fullChartView = document.getElementById('full-chart-view');
            const fullChartList = document.getElementById('full-chart-list');
            const btnMoreChart = document.getElementById('btn-more-chart');
            const btnCloseChart = document.getElementById('btn-close-chart');
            const btnPlayAll = document.getElementById('btn-play-all'); // ëª¨ë‘ ì¬ìƒ ë²„íŠ¼
            const newAlbumList = document.getElementById('new-album-list');
            const comingSoonList = document.getElementById('coming-soon-list');
            const playerScreen = document.getElementById('player-screen');
            const miniPlayer = document.getElementById('mini-player');
            const miniPlayBtn = document.getElementById('mini-play-btn');
            const errorBox = document.getElementById('error-box');
            const bootScreen = document.getElementById('boot-screen');
            const homeScreen = document.getElementById('home-screen');
            const popupModal = document.getElementById('popup-modal');
            const popupClose = document.getElementById('popup-close');
            const btnLike = document.getElementById('btn-like'); 
            const toneArm = document.getElementById('tone-arm');
            const btnRepeat = document.getElementById('btn-repeat'); 
            
            const miniCover = document.getElementById('mini-cover');
            const miniTitle = document.getElementById('mini-title');
            const miniArtist = document.getElementById('mini-artist');
            const miniIconPlay = document.getElementById('mini-icon-play');
            const miniIconPause = document.getElementById('mini-icon-pause');
            const lpDisk = document.getElementById('lp-disk');
            const btnPlay = document.getElementById('btn-play');
            const iconPlay = document.getElementById('icon-play');
            const iconPause = document.getElementById('icon-pause');
            const progressFill = document.getElementById('progress-fill');
            const progressHandle = document.getElementById('progress-handle');
            const seekSlider = document.getElementById('seek-slider');
            const timeCurr = document.getElementById('current-time');
            const timeDur = document.getElementById('duration');
            const playerBgImage = document.getElementById('player-bg-image');

            // 1. ì¸íŠ¸ë¡œ ì²˜ë¦¬
            let hasEntered = false;
            const enterHome = () => {
                if (hasEntered) return;
                hasEntered = true;
                bootScreen.classList.add('fade-out');
                homeScreen.classList.remove('opacity-0');
            };
            setTimeout(enterHome, 3000);
            bootScreen.addEventListener('click', enterHome);

            // íŒì—… ë¡œì§
            const showPopup = () => popupModal.classList.remove('hidden');
            popupClose.onclick = () => popupModal.classList.add('hidden');
            popupModal.onclick = (e) => { if (e.target === popupModal) popupModal.classList.add('hidden'); };

            // ì°¨íŠ¸ ë”ë³´ê¸° í™”ë©´ ë¡œì§
            btnMoreChart.onclick = () => { fullChartView.classList.remove('translate-x-full'); };
            btnCloseChart.onclick = () => { fullChartView.classList.add('translate-x-full'); };

            // â–¶ ëª¨ë‘ ì¬ìƒ ë²„íŠ¼ ë¡œì§ (ìˆ˜ì •ë¨: ê°•ì œ ì¬ìƒ ì²˜ë¦¬)
            btnPlayAll.onclick = () => {
                if (currentIdx === 0) {
                    // ì´ë¯¸ ì²« ë²ˆì§¸ ê³¡ì´ ì„ íƒë˜ì–´ ìˆìœ¼ë©´ ë°”ë¡œ ì¬ìƒ
                    playerScreen.classList.remove('translate-y-full');
                    miniPlayer.classList.remove('translate-y-full');
                    togglePlay(true); 
                } else {
                    // ì•„ë‹ˆë©´ ì²« ë²ˆì§¸ ê³¡ìœ¼ë¡œ ì´ë™ (openPlayer ë‚´ë¶€ì—ì„œ ì¬ìƒë¨)
                    openPlayer(0);
                }
            };

            // ì¢‹ì•„ìš”
            const createFloatingHeart = (type) => {
                const heart = document.createElement('div');
                const rect = btnLike.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                heart.className = 'heart-effect';
                heart.innerHTML = `<svg width="26" height="26" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>`;
                heart.style.left = `${centerX}px`;
                heart.style.top = `${centerY}px`;
                heart.classList.add(type === 'up' ? 'anim-fly-up' : 'anim-return');
                document.body.appendChild(heart);
                setTimeout(() => heart.remove(), 1000);
            };

            btnLike.onclick = () => {
                isLiked = !isLiked;
                const svg = btnLike.querySelector('svg');
                if (isLiked) {
                    svg.setAttribute('fill', 'currentColor');
                    btnLike.classList.remove('text-white/40');
                    btnLike.classList.add('text-[#005ED2]');
                    createFloatingHeart('up');
                } else {
                    svg.setAttribute('fill', 'none');
                    btnLike.classList.add('text-white/40');
                    btnLike.classList.remove('text-[#005ED2]');
                    createFloatingHeart('down');
                }
                btnLike.classList.add('scale-125');
                setTimeout(() => btnLike.classList.remove('scale-125'), 200);
            };

            // ë°˜ë³µ ì¬ìƒ
            btnRepeat.onclick = () => {
                isRepeat = !isRepeat;
                audio.loop = isRepeat;
                if (isRepeat) {
                    btnRepeat.classList.remove('text-white/30');
                    btnRepeat.classList.add('text-[#005ED2]');
                } else {
                    btnRepeat.classList.add('text-white/30');
                    btnRepeat.classList.remove('text-[#005ED2]');
                }
            };

            // í—¬í¼ í•¨ìˆ˜: ìˆœìœ„ ë³€ë™ HTML ìƒì„±
            const getRankHTML = (status) => {
                if (status === 'up') return `<span class="text-red-500 text-[10px] font-bold flex items-center justify-center">â–²</span>`;
                if (status === 'down') return `<span class="text-blue-500 text-[10px] font-bold flex items-center justify-center">â–¼</span>`;
                if (status === 'new') return `<span class="text-yellow-500 text-[8px] font-bold tracking-tighter">NEW</span>`;
                return `<span class="text-gray-400 text-[10px] flex items-center justify-center">-</span>`;
            };

            // ë Œë”ë§: New Album (ID ì—­ìˆœ - ìµœì‹ ìˆœ)
            const renderNewAlbumList = () => {
                newAlbumList.innerHTML = '';
                const sortedByNewest = [...songs].sort((a, b) => b.id - a.id);
                
                sortedByNewest.forEach((song) => {
                    const originalIndex = songs.indexOf(song); 
                    const div = document.createElement('div');
                    div.className = "flex-shrink-0 w-40 group cursor-pointer";
                    div.innerHTML = `
                        <div class="w-40 h-40 rounded-2xl overflow-hidden bg-gray-800 mb-3 shadow-lg relative">
                            <img src="${song.cover}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" onerror="this.style.display='none'">
                            <div class="absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                <div class="w-12 h-12 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center border border-white/30">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                                </div>
                            </div>
                        </div>
                        <h3 class="text-base font-bold text-black truncate">${song.title}</h3>
                        <p class="text-xs text-gray-500 truncate font-medium">${song.artist}</p>
                        <div class="mt-3 inline-flex items-center gap-2 bg-[#005ED2] text-white px-3 py-1.5 rounded-full font-bold text-xs hover:bg-[#005ED2]/80 transition-colors shadow-lg shadow-[#005ED2]/20">
                            <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                            Play Now
                        </div>
                    `;
                    div.addEventListener('click', () => openPlayer(originalIndex));
                    newAlbumList.appendChild(div);
                });
            };

            // ë Œë”ë§: ì‹¤ì‹œê°„ ì°¨íŠ¸ (ìŠ¬ë¼ì´ë“œ ë°©ì‹ - 3ê°œì”© ë¬¶ìŒ)
            const renderChartList = () => {
                chartSlider.innerHTML = '';
                const chunkSize = 3;
                
                for (let i = 0; i < songs.length; i += chunkSize) {
                    const chunk = songs.slice(i, i + chunkSize);
                    
                    const slide = document.createElement('div');
                    slide.className = "min-w-full snap-center flex flex-col gap-1"; 
                    
                    chunk.forEach((song, idx) => {
                        const realIndex = i + idx;
                        const rank = realIndex + 1;
                        const rankColorClass = rank <= 3 ? "text-[#005ED2]" : "text-gray-800";

                        const item = document.createElement('div');
                        item.className = "flex items-center gap-4 p-3 rounded-xl hover:bg-gray-100 active:scale-98 transition-all cursor-pointer group";
                        item.innerHTML = `
                            <div class="flex flex-col items-center justify-center w-8 mr-1">
                                <span class="${rankColorClass} text-lg font-bold font-logo leading-none mb-1">${rank}</span>
                                ${getRankHTML(song.rankStatus)}
                            </div>
                            <div class="w-12 h-12 rounded-lg bg-gray-800 overflow-hidden relative flex-shrink-0">
                                <img src="${song.cover}" class="w-full h-full object-cover" onerror="this.style.opacity='0.5'">
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-base font-medium text-black truncate">${song.title}</h3>
                                <p class="text-xs text-gray-500 truncate">${song.artist}</p>
                            </div>
                            <button class="text-gray-400 hover:text-black">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
                            </button>
                        `;
                        item.addEventListener('click', () => openPlayer(realIndex));
                        slide.appendChild(item);
                    });
                    chartSlider.appendChild(slide);
                }
            };

            // ë Œë”ë§: ì „ì²´ ì°¨íŠ¸ (ë”ë³´ê¸°ìš© ì„¸ë¡œ ë¦¬ìŠ¤íŠ¸)
            const renderFullChartList = () => {
                fullChartList.innerHTML = '';
                songs.forEach((song, index) => {
                    const rank = index + 1;
                    const rankColorClass = rank <= 3 ? "text-[#005ED2]" : "text-gray-800";

                    const div = document.createElement('div');
                    div.className = "flex items-center gap-3 p-3 rounded-xl hover:bg-gray-100 active:scale-98 transition-all cursor-pointer border-b border-gray-100 last:border-0";
                    div.innerHTML = `
                        <div class="flex flex-col items-center justify-center w-8 mr-1 flex-shrink-0">
                            <span class="${rankColorClass} text-lg font-bold font-logo leading-none mb-1">${rank}</span>
                            ${getRankHTML(song.rankStatus)}
                        </div>
                        <div class="w-12 h-12 rounded-lg bg-gray-800 overflow-hidden relative flex-shrink-0">
                            <img src="${song.cover}" class="w-full h-full object-cover">
                        </div>
                        <div class="flex-1 min-w-0 flex flex-col justify-center">
                            <h3 class="text-sm font-bold text-black leading-snug break-keep">${song.title}</h3>
                            <p class="text-xs text-gray-500 mt-0.5 break-keep">${song.artist}</p>
                        </div>
                        <button class="p-2 text-gray-400 hover:text-black flex-shrink-0">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        </button>
                    `;
                    div.addEventListener('click', () => {
                        openPlayer(index);
                        fullChartView.classList.add('translate-x-full'); // ë‹«ê¸°
                    });
                    fullChartList.appendChild(div);
                });
            };

            const renderComingSoonList = () => {
                comingSoonList.innerHTML = '';
                comingSoonSongs.forEach((song) => {
                    const div = document.createElement('div');
                    div.className = "flex-shrink-0 w-32 group cursor-pointer";
                    div.innerHTML = `
                        <div class="w-32 h-32 rounded-xl overflow-hidden bg-gray-800 mb-2 shadow-lg relative">
                            <img src="${song.cover}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" onerror="this.style.display='none'">
                            <div class="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                <div class="w-8 h-8 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                                </div>
                            </div>
                        </div>
                        <h3 class="text-sm font-bold text-black truncate">${song.title}</h3>
                        <p class="text-[10px] text-gray-500 truncate font-medium">${song.artist}</p>
                    `;
                    div.addEventListener('click', showPopup);
                    comingSoonList.appendChild(div);
                });
            };

            // í”Œë ˆì´ì–´ ë¡œì§
            const loadSongData = (index) => {
                const song = songs[index];
                audio.src = song.src;
                document.getElementById('song-title').innerText = song.title;
                document.getElementById('song-artist').innerText = song.artist;
                document.getElementById('cover-image').src = song.cover;
                playerBgImage.src = song.cover;
                miniTitle.innerText = song.title;
                miniArtist.innerText = song.artist;
                miniCover.src = song.cover;
                errorBox.classList.add('hidden');
                
                timeCurr.innerText = "00:00";
                timeDur.innerText = "00:00";
            };

            const openPlayer = (index) => {
                if (currentIdx === index) {
                    playerScreen.classList.remove('translate-y-full');
                    return;
                }
                currentIdx = index;
                loadSongData(index);
                playerScreen.classList.remove('translate-y-full');
                miniPlayer.classList.remove('translate-y-full');
                setTimeout(() => togglePlay(true), 300);
            };

            miniPlayer.addEventListener('click', () => {
                playerScreen.classList.remove('translate-y-full');
            });

            document.getElementById('btn-minimize').onclick = () => {
                playerScreen.classList.add('translate-y-full');
                miniPlayer.classList.remove('translate-y-full');
            };

            const togglePlay = (forcePlay = null) => {
                const shouldPlay = forcePlay === null ? audio.paused : forcePlay;
                if (shouldPlay) {
                    audio.play().then(() => updateUI(true)).catch(e => {
                        console.error(e);
                        errorBox.classList.remove('hidden');
                        updateUI(false);
                    });
                } else {
                    audio.pause();
                    updateUI(false);
                }
            };

            const updateUI = (playing) => {
                isPlaying = playing;
                if (playing) {
                    iconPlay.classList.add('hidden'); iconPause.classList.remove('hidden');
                    miniIconPlay.classList.add('hidden'); miniIconPause.classList.remove('hidden');
                    lpDisk.classList.add('running');
                    toneArm.style.transform = "rotate(10deg)";
                } else {
                    iconPlay.classList.remove('hidden'); iconPause.classList.add('hidden');
                    miniIconPlay.classList.remove('hidden'); miniIconPause.classList.add('hidden');
                    lpDisk.classList.remove('running');
                    toneArm.style.transform = "rotate(-25deg)";
                }
            };

            // ì´ë²¤íŠ¸
            btnPlay.addEventListener('click', () => togglePlay());
            miniPlayBtn.addEventListener('click', (e) => { e.stopPropagation(); togglePlay(); });
            document.getElementById('btn-next').addEventListener('click', () => {
                let nextIdx = currentIdx + 1;
                if (nextIdx >= songs.length) nextIdx = 0;
                openPlayer(nextIdx);
            });
            document.getElementById('btn-prev').addEventListener('click', () => {
                let prevIdx = currentIdx - 1;
                if (prevIdx < 0) prevIdx = songs.length - 1;
                openPlayer(prevIdx);
            });
            
            // ë…¸ë˜ ì¢…ë£Œ ì‹œ ìë™ ë‹¤ìŒ ê³¡ ì¬ìƒ (ìˆ˜ì •ë¨)
            audio.addEventListener('ended', () => { 
                if (isRepeat) {
                    // ë°˜ë³µ ì¬ìƒì€ audio.loopê°€ ì²˜ë¦¬í•˜ì§€ë§Œ UI ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ë†”ë‘ 
                } else {
                    // ë‹¤ìŒ ê³¡ìœ¼ë¡œ ìë™ ì´ë™
                    if (currentIdx < songs.length - 1) {
                        currentIdx++;
                        openPlayer(currentIdx);
                    } else {
                        togglePlay(false); 
                        audio.currentTime = 0; 
                    }
                }
            });

            // ì¬ìƒë°” í„°ì¹˜
            function getClientX(e) { return e.touches ? e.touches[0].clientX : e.clientX; }
            function onScrub(e) {
                const rect = document.getElementById('progress-container').getBoundingClientRect();
                return Math.max(0, Math.min(100, ((getClientX(e) - rect.left) / rect.width) * 100));
            }
            const startScrub = (e) => {
                isDragging = true;
                progressFill.style.width = `${onScrub(e)}%`;
                progressFill.classList.add('no-transition');
            };
            const moveScrub = (e) => {
                if (isDragging) {
                    e.preventDefault();
                    progressFill.style.width = `${onScrub(e)}%`;
                }
            };
            const endScrub = (e) => {
                if (isDragging) {
                    isDragging = false;
                    if(audio.duration) audio.currentTime = (parseFloat(progressFill.style.width) / 100) * audio.duration;
                    progressFill.classList.remove('no-transition');
                }
            };
            const pContainer = document.getElementById('progress-container');
            pContainer.addEventListener('mousedown', startScrub);
            pContainer.addEventListener('touchstart', startScrub, {passive: false});
            document.addEventListener('mousemove', moveScrub);
            document.addEventListener('touchmove', moveScrub, {passive: false});
            document.addEventListener('mouseup', endScrub);
            document.addEventListener('touchend', endScrub);

            audio.addEventListener('timeupdate', () => {
                timeCurr.innerText = formatTime(audio.currentTime);
                if (!isDragging && !isNaN(audio.duration) && isFinite(audio.duration)) {
                    const percent = (audio.currentTime / audio.duration) * 100;
                    progressFill.style.width = `${percent}%`;
                    progressHandle.style.left = `${percent}%`;
                    document.getElementById('mini-progress').style.width = `${percent}%`; 
                    seekSlider.value = percent;
                    timeDur.innerText = formatTime(audio.duration);
                }
            });
            audio.addEventListener('loadedmetadata', () => { timeDur.innerText = formatTime(audio.duration); });

            function formatTime(s) {
                if(isNaN(s) || !isFinite(s)) return "00:00";
                const min = Math.floor(s / 60);
                const sec = Math.floor(s % 60);
                return `${min}:${sec < 10 ? '0'+sec : sec}`;
            }

            // ì´ˆê¸° ì‹¤í–‰
            renderNewAlbumList();
            renderChartList();
            renderFullChartList();
            renderComingSoonList();
            loadSongData(0);
        });
    </script>
</body>
</html>